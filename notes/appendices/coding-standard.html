<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
    <meta name="keywords" content="Magento, Magento2, 开发, 文档, 手册, 笔记" />
    <meta name="description" content="编码规范 - Magento 2 开发笔记" />
    <base href="/"/>
    <title>编码规范 - Magento 2 开发笔记</title>
    <link rel="shortcut icon" type="image/x-icon" href="web/images/favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="web/css/notes.css"/>
</head>
<body>
<main>
    <article>
        <h1>编码规范</h1>
<p>Magento 2 有一套自己的编码规范：</p>
<p><a href="https://devdocs.magento.com/guides/v2.4/coding-standards/bk-coding-standards.html">https://devdocs.magento.com/guides/v2.4/coding-standards/bk-coding-standards.html</a></p>
<p>并提供了一个基于 <a href="https://github.com/squizlabs/PHP_CodeSniffer">PHP_CodeSniffer</a> 的检测工具：</p>
<p><a href="https://devdocs.magento.com/marketplace/sellers/code-sniffer.html">https://devdocs.magento.com/marketplace/sellers/code-sniffer.html</a></p>
<p>执行如下指令安装工具：</p>
<pre><code class="language-sh">composer create-project magento/magento-coding-standard --stability=dev magento-coding-standard</code></pre>
<p>安装完成后会自动生成一个 magento-coding-standard 文件夹，进入这个文件夹后执行如下指令进行检测：</p>
<pre><code class="language-sh">vendor/bin/phpcs \
  --standard=Magento2 \
  --error-severity=10 \
  --extensions=php,phtml,js \
  --exclude=Magento2.Legacy.Copyright,Magento2.Legacy.CopyrightAnotherExtensionsFiles \
  --report=summary \
  --ignore-annotations \
    &lt;path-to-source&gt;</code></pre>
<p>以下是相关参数简述：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>standard</code></td>
<td>检测标准，这里固定为 Magento2</td>
</tr>
<tr>
<td><code>error-severity</code></td>
<td>错误级别</td>
</tr>
<tr>
<td><code>extensions</code></td>
<td>检测类型，以逗号分割</td>
</tr>
<tr>
<td><code>exclude</code></td>
<td>跳过的检测规则。如果不是为 Magento 贡献代码则跳过 copyright 规则</td>
</tr>
<tr>
<td><code>report</code></td>
<td>报告类型，以逗号分割。省略此项（或设置为 full）会列出完整的错误报告</td>
</tr>
<tr>
<td><code>ignore-annotations</code></td>
<td>跳过代码中注释为 phpcs: 的内容</td>
</tr>
<tr>
<td><code>&lt;path-to-source&gt;</code></td>
<td>需要检查的目录或文件的绝对路径</td>
</tr>
</tbody>
</table>
<p>以下是错误级别说明：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>级别</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Error</td>
<td>10</td>
<td>严重问题，可能是 bug 或安全漏洞</td>
</tr>
<tr>
<td>Warning</td>
<td>9</td>
<td>可能导致出错的安全隐患</td>
</tr>
<tr>
<td>Warning</td>
<td>8</td>
<td>与 Magento 的编码规范或设计思想不符</td>
</tr>
<tr>
<td>Warning</td>
<td>7</td>
<td>一般代码问题</td>
</tr>
<tr>
<td>Warning</td>
<td>6</td>
<td>编码格式问题</td>
</tr>
<tr>
<td>Warning</td>
<td>5</td>
<td>PHPDoc 或注释的格式问题</td>
</tr>
</tbody>
</table>
<p>其他用法参考：</p>
<p><a href="https://github.com/squizlabs/PHP_CodeSniffer/wiki/Usage">https://github.com/squizlabs/PHP_CodeSniffer/wiki/Usage</a>
<a href="https://github.com/squizlabs/PHP_CodeSniffer/wiki/Advanced-Usage">https://github.com/squizlabs/PHP_CodeSniffer/wiki/Advanced-Usage</a></p>
    </article>
</main>
<script src="web/js/lib/require.js" type="text/javascript"></script>
<script src="web/js/require-config.js" type="text/javascript"></script>
<script src="web/js/notes.js" type="text/javascript"></script>
</body>
</html>