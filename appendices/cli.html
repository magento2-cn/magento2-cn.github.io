<!DOCTYPE html>
<html>
    <head>
        <title>常用命令及参数 - Magento 2 笔记</title>
        <base href="/" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
        <link rel="shortcut icon" type="image/x-icon" href="web/images/favicon.ico" />
        <link rel="stylesheet" type="text/css" media="all" href="web/css/style.css" />
        <link rel="stylesheet" type="text/css" media="all" href="web/css/jquery.mCustomScrollbar.min.css" />
    </head>
    <body>
        <header></header>
        <main>
            <aside></aside>
            <article>
                <h1>常用命令及参数</h1>
                <pre id="article-source">
## Magento 命令

以下命令须在站点根目录下执行：

### 清空主题文件

```sh
rm -rf pub/static/*
rm -rf var/view_preprocessed
```


### 开启维护模式，清空所有临时文件

```sh
php bin/magento maintenance:enable
```

```sh
rm -rf generated/*
rm -rf pub/static/*
rm -rf var/di
rm -rf var/generation
rm -rf var/view_preprocessed
rm -rf var/cache
rm -rf var/page_cache
```

```sh
chown -R www-data:www-data ./generated
chown -R www-data:www-data ./var
```


### 更新组件数据库，并开启产品模式（自动部署）

```
php bin/magento setup:upgrade

php bin/magento deploy:mode:set production -vvv

php bin/magento indexer:reindex

```


### 开启产品模式（手动分步部署）

```
php bin/magento deploy:mode:set production --skip-compilation
php bin/magento setup:di:compile

php bin/magento setup:static-content:deploy zh_Hant_HK
php bin/magento setup:static-content:deploy en_US
php bin/magento setup:static-content:deploy zh_Hans_CN

```


### 更新静态文件（无需开启维护模式）

```
rm -rf var/view_preprocessed
rm -rf var/cache
rm -rf var/page_cache

php bin/magento cache:flush
php bin/magento setup:static-content:deploy zh_Hant_HK
php bin/magento setup:static-content:deploy en_US
php bin/magento setup:static-content:deploy zh_Hans_CN

find ./pub/static/ -name '*.css' -print|xargs rm -rf

```

## Linux 命令


### 文件用户组及权限
```
chown -R apache:apache .
find ./ -type f -print|xargs chmod 644;
find ./ -type d -print|xargs chmod 755;
```


### 打包及解压

.tar
```
解包：tar xvf FileName.tar
打包：tar cvf FileName.tar DirName
```

.tar.gz 和 .tgz
```
解压：tar zxvf FileName.tar.gz
压缩：tar zcvf FileName.tar.gz DirName
```

.zip
```
解压：unzip FileName.zip
压缩：zip FileName.zip DirName
```

.bz2
```
解压：bzip2 -d FileName.bz2
解压：tar -xjvf xxx.bz2
压缩：bzip2 -z FileName
```


### 导出 GIT 最新更新

```
git archive --output=latest.tar HEAD \
$(git diff-tree -r --no-commit-id --name-only --diff-filter=ACMRT <CommitID1> <CommitID2>)
```


### 在 GIT 中忽略本地文件

```
git update-index --skip-worktree path/to/file
```

                </pre>
            </article>
        </main>
        <footer></footer>
        <script type="text/javascript" src="web/js/require.js"></script>
        <script type="text/javascript" src="web/js/site.js"></script>
    </body>
</html>